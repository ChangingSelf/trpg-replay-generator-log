# 更新日志

此项目的所有显著更改都将记录在此文件中。

格式基于[维护更新日志（Keep a Changelog）](https://keepachangelog.com/en/1.0.0/)，
并且该项目遵循 [语义版本控制（Semantic Versioning）](https://semver.org/spec/v2.0.0.html)。


## [1.20.2] - 2022-12-08

命令`TRGL: Edit Audio Box # 批量编辑音效框`新增两个选项：

- 给指定角色删除文件路径音效
- 给指定角色删除所有音效

## [1.20.1] - 2022-12-08

把插件最低兼容的vscode版本升级到了1.74.0，可能会用上vscode更新的一些新功能。vscode应该会自动更新，如果没有更新，也可以在顶部菜单【帮助】一栏里面找到【检查更新】，对具体更新内容感兴趣可以看[官方更新日志](https://code.visualstudio.com/updates/v1_74)

## [1.20.0] - 2022-12-07

新增命令`TRGL: Edit Audio Box # 批量编辑音效框`，用于上位替代`TRGL: Add Sound Effects In Batches # 批量添加音效`和`TRGL: Add Asterisk Marks # 批量添加语音待处理星标{*}`，后二者即将弃用

新命令不再是简单的正则替换，而是可以真正指定特定角色（无论是否有差分，当前角色框是否有其他角色都可以）

同时，新增删除指定角色的指定音效的选项，音效框也不会误删除

#### `TRGL: Edit Audio Box`

批量编辑音效框，拥有多个选项：

- 给全部对话行添加{*}
- 只给没有音效框的对话行行添加{*}
- 给指定角色添加指定音效(默认为{*})
- 给指定角色删除指定音效(默认为{*})
- 去掉纯标点符号行的{*}

## [1.19.3] - 2022-12-06

- 修复NA不被认作媒体对象的问题。现在`{NA}`和`{NA;*时间}`的写法不会报错了

## [1.19.2] - 2022-12-06

- `TRGL: Migrate Log`命令已弃用，请使用`TRGL: Convert Log`命令进行活字引擎和回声工坊Log格式互相转换

## [1.19.1] - 2022-12-06

- `TRGL: Convert Log`新增对QQ聊天消息（直接复制和导出两种都行）和已经染色的跑团记录（塔、赵、溯洄）的转换

## [1.19.0] - 2022-12-05

新增命令：

#### `TRGL: Convert Log`

转换跑团Log格式，对当前文件使用，在旁边生成一个转换好的回声工坊log文件，目前支持：

- 猫爷TRPG => 回声工坊
- 菠萝文字团平台txt => 回声工坊
- 菠萝文字团平台json => 回声工坊

## [1.18.7] - 2022-12-04

代码诊断新增音效框相关：

- 检查语音合成指定文本只能包含`，。：？！“”`等中文符号
- 检查音效框的文件路径是否正确
- 检查音效框使用的是否为wav文件
- 检查音效媒体是否在媒体定义文件中已经定义

## [1.18.6] - 2022-12-04

- 前一个更新没考虑到删除待合成星标的情况，加上了对应选项“删除某个角色后的所有音效框（会误伤普通音效，待优化）”

## [1.18.5] - 2022-12-04

- `TRGL: Add Asterisk Marks`命令新增选项：把某个角色已经合成的语音框删除。可以先添加全部{*}，再删除某个特定角色的语音框，实现只给某个角色不添加星标


## [1.18.4] - 2022-12-04

关于`TRGL: Copy Log`命令的一些小修复：
- 修复了复制内容中会出现角色差分以及手动换行符号的问题
- 可以只复制选中的文本，如果没有选中，则复制当前打开的全文
- 支持快捷键“Ctrl+Shift+C”

## [1.18.3] - 2022-12-04

- 新增“TRGL: Copy Log # 以不同格式复制Log文件文本”命令，支持复制为“软件「朗读女」的「多角色朗读」的格式：[角色名]说话内容”以及“无角色框的内容文本”

## [1.18.2] - 2022-12-02

- 修复了文本纠错功能无法识别文本中的星号（*）的问题（为什么会报错呢？奇怪）

## [1.18.1] - 2022-12-01

- 代码片段新增回声工坊1.1.0版的`inline_method_apply`设置行
- 骰子行新增对出目大于骰面数的代码诊断

## [1.18.0] - 2022-11-30

- 新增调用阿里云key进行文本纠错的功能，详细使用方法见：https://www.wolai.com/yxchangingself/D5svMQ4DWThCzUyauUbSb

## [1.17.1] - 2022-11-30

- 修复了多音字诊断的下划线标注错位的问题

## [1.17.0] - 2022-11-29

- 新增多音字诊断和快速修复，可在设置中调整多音字表和提示等级，并提供“在行尾添加合成指定文本的语音的标志便于修改”的快速修复

## [1.16.8] - 2022-11-29

- 修复设置行行数统计错误的问题（刚刚那次没有完全修复）

## [1.16.7] - 2022-11-29

- 修复设置行行数统计错误的问题

## [1.16.6] - 2022-11-29

- 状态栏显示内容修改
- 统计功能输出内容格式美化

## [1.16.5] - 2022-11-29

- 统计功能优化

## [1.16.4] - 2022-11-27

- 在package.json中添加了MIT开源许可证（虽然1.16.2就添加了LICENSE文件，但还是根据扩展开发文档加上这个吧）

## [1.16.3] - 2022-11-27

- 修复一键复原角色的待合成星标功能对带有尖括号方法的对话行无法匹配的问题

## [1.16.2] - 2022-11-27

没有功能变化，仅调整了文档、插件名称、主题名称等

- 修改插件名称为“回声工坊扩展”，修改简介为中文
- 修改自带的两个主题的名称
- 修改README文件（帮助文档）

## [1.16.1] - 2022-11-25

- 现在角色配置表不止能用tsv文件，也适配xlsx文件了

## [1.16.0] - 2022-11-25

- 一键生成角色配置文件新增“从媒体定义文件生成”的选项，根据立绘媒体名生成角色配置文件的差分行，例如“憧憬少_微笑”这个Animation媒体会被转换为“憧憬少”角色的“微笑”差分，对应的立绘就是“憧憬少_微笑”这个立绘媒体。

## [1.15.2] - 2022-11-25

- 常驻立绘行(`<animation>`)自动补全立绘
- 常驻气泡行(`<bubble>`)自动补全气泡
- 聊天窗内容清除行(`<clear>`)自动补全聊天窗

## [1.15.1] - 2022-11-25

- 自动补全新增角色名补全，输入对话框的名字框时触发，多个角色时也支持

## [1.15.0] - 2022-11-20

- 媒体定义文件现在支持按照媒体类型折叠以及折叠标记折叠（#s开头和#e结尾）

## [1.14.9] - 2022-11-19

- 将侧边栏“剧本中已出现的角色”这一分栏改为“可用角色”，现在除了可以显示剧本中已出现的角色（前面带*号）之外，还能显示角色配置表中的角色，并提供快速插入角色差分的按钮

## [1.14.8] - 2022-11-19

- 修复中文冒号前面为非单词会错误高亮的问题

## [1.14.7] - 2022-11-08

- 修复一键替换骰娘文本为动画行功能无法识别D前数字的问题

## [1.14.6] - 2022-11-08

- 修复生成媒体定义文件命令默认打开的文件夹的路径

## [1.14.5] - 2022-10-21

- 新增背景行自动补全（在<background>后输入英文冒号触发）和音效自动补全（输入左花括号触发）

## [1.14.4] - 2022-10-21

- bug修复：当读取媒体定义文件或者角色配置文件失败时，代码诊断的其他功能不会受到牵连

## [1.14.3] - 2022-10-21

- 代码诊断功能新增：当对话行单行字数或者总字数超出用户设置的上限时，发出警告（可将对应字数设置为负数以关闭此功能）
- 新增设置：TotalLength 代码诊断所使用的对话行内容总字数，可以使用局部配置的方式来设置它，注意与对话行单行字数做区分

## [1.14.2] - 2022-10-18

本次更新主要是为了适应1.1.0版回声工坊，记得在设置里面把回声工坊exe路径改为新版回声工坊的路径

- 图层默认值修改为：BG2,BG1,Am3,Am2,Am1,AmS,Bb,BbS，由于新版去除了BG3和增加了BbS、AmS图层，注意更新vscode插件设置的值，避免影响调用回声工坊的功能出现问题
- 新增clear行的语法高亮
- 新增代码片段：
  - `background`：带切换效果下拉列表的背景行
  - `animation`：常驻立绘行
  - `clear`：聊天窗内容清除行
  - `set FreePos`：设置自由位置

## [1.14.1] - 2022-10-14

- 代码诊断功能新增背景行检查

## [1.14.0] - 2022-10-14

- 新增代码诊断功能，当角色或者差分未在角色配置表中定义的时候，会划红色波浪线进行提醒

## [1.13.5] - 2022-10-09

- 紧急修复快捷键F5在rgl文件以外的地方也起作用的bug

## [1.13.4] - 2022-10-09

- 将常用命令加入右键菜单当中
- 现在可以单击状态栏来启动统计命令

## [1.13.3] - 2022-10-08

- 修复了大纲无法实时更新的bug，无需手动刷新
- 侧边栏大纲现在可以直接单击跳转，无需点击旁边的按钮
- 侧边栏大纲可以使用折叠标记作为大纲节点，可嵌套（折叠标记正确闭合才会得到正确大纲），在【设置】->【侧边栏】中可以找到相应设置，默认使用背景行作为大纲节点

## [1.13.2] - 2022-10-08

- 将一键生成媒体定义文件和角色配置文件的两个命令的路径输入方式改为文件对话框
- 一键生成媒体定义文件的命令的媒体文件夹和输出文件的路径不必一致

## [1.13.1] - 2022-10-06

- 语法高亮兼容回声工坊新语法：`<animation>`行和`<bubble>`行

## [1.13.0] - 2022-10-06

- 当你临时想要添加新的背景或者音效的时候可以不必特地打开回声工坊GUI了，在侧边栏点击“+”图标即可选择媒体添加到媒体定义文件，可以多选
- 可以在侧边栏点击预览背景
- 侧边栏节点的文字按钮换成了图标按钮

## [1.12.1] - 2022-10-06

- 修复了侧边栏在本插件之外的地方也显示刷新按钮的bug
- 修复了状态栏不更新信息的bug

## [1.12.0] - 2022-10-04

- 侧边栏新增“可用的背景”和“可用的音效”，会读取已配置的媒体定义文件，点击可插入到剧本文件中
- 侧边栏新增“大纲”，会将背景行视作跳转节点，目前修改后需手动点击按钮刷新

## [1.11.0] - 2022-10-03

- 新增命令“TRGL: Import Local Sound”，以本地wav文件替换log文件中的待处理星标。运行时就是没有进度条的，需要耐心等一下（输出框、状态栏、消息框、进度条都只能在结束时弹出，难以理解，找了四个小时找不到原因就算了）
- 修复：命令“TRGL: Adjust Sound Effects Time In Batches # 批量调整音效时长”的时长保留3位小数

## [1.10.0] - 2022-10-02

- 现在可以自动补全角色差分了，只要你正确配置了角色配置表，且角色配置表是tsv格式（xlsx格式暂时无法解析）

## [1.9.0] - 2022-09-29

- 为庆祝活字引擎3正式发售，增加了有损、不可逆的回声工坊和活字引擎log格式互相转换命令“TRGL: Migrate Log”

## [1.8.0] - 2022-09-28

- 命令“TRGL: Replace DiceMaid Line # 一键替换骰娘文本为骰子动画行”已实装

## [1.7.3] - 2022-09-28

- 给所有命令加上了中文注释

## [1.7.2] - 2022-09-21

- 修改了侧边栏图标

## [1.7.1] - 2022-09-20

- 修复侧边栏无法显示欢迎页面的bug

## [1.7.0] - 2022-09-20

- 新增侧边栏，可以通过侧边栏查看当前rgl文件有哪些角色差分，点击按钮手动刷新

## [1.6.1] - 2022-09-20

- 小修了一下内置伊可

## [1.6.0] - 2022-09-10

- 新增本插件的新手教程，安装后自动打开教程，使用“打开演练”或者“Open Walkthrough”命令可以手动打开。

## [1.5.1] - 2022-09-08

- 答疑机器人的岗位由交流群的骰郎“伊可”接手！

## [1.5.0] - 2022-09-08

- 作为测试功能，添加了“TRGL: Chat With DiceBot”命令，可以询问答疑机器人一些问题（条目在施工中），此功能可能会移除

## [1.4.0] - 2022-09-07

- 新增状态栏信息，现在可以在状态栏看到预估视频时长等统计信息

## [1.3.3] - 2022-08-27

- 给命令“TRGL: Add Asterisk Marks”新增“把某个角色已经合成的语音框替换为待合成星标以便重新合成”选项

## [1.3.2] - 2022-08-02

- 给命令“TRGL: Add Asterisk Marks”新增“去掉纯标点符号行的待处理星标”选项

## [1.3.1] - 2022-08-02

- 给命令“TRGL: Add Asterisk Marks”新增“只给无音效框的行添加待处理星标”选项
- 在README文件中添加了更详细的教程的链接

## [1.3.0] - 2022-06-27

- 新增命令“TRGL: Adjust Sound Effects Time In Batches”。批量调整合成语音的时间，输入角色名以及时间差，就可以给合成的语音框后的时间批量加上这个时间差，用于调整微软音源的音频空白问题

## [1.2.2] - 2022-06-19

- 修复文档中错误的唤出命令面板的快捷键

## [1.2.1] - 2022-06-19

- 新增代码片段“quickly configurate”，快速在本文件中配置与本文件同目录下的媒体定义文件media.txt和角色配置表characters.tsv

## [1.2.0] - 2022-06-18

- 新增亮色主题“rgl light theme”
- 新增命令“TRGL: Open Media View”。打开某个媒体定义文件，使用该命令可以解析其中的媒体元素列成表格（然而现在仅仅可以看到列表，无法预览和编辑，敬请期待之后的更新）。该命令有可能在之后的更新中改名或删去。

## [1.1.1] - 2022-06-15

- 对话行悬停提示优化，现在显示的是换行预览，开头的数字是本行字数。可以使用 `#ll 50`或者 `#lineLength 50`将每行字数限制设定为50，这里的数字可以改成其他整数
- 修复悬停功能会在输出面板刷屏的问题
- 语法高亮添加对话行方括号后中文冒号的错误提示、对话行中的手动换行符号的高亮、配置行的高亮

## [1.1.0] - 2022-06-12

- 新增悬停提示功能，默认开启，可以在设置中关掉
- 新增命令 `TRGL: Open Document`，可以快速打开配置的回声工坊软件路径下的 `README.md`文件

## [1.0.5] - 2022-06-11

- `TRGL: Count`命令现在可以只统计选中部分的内容了，当未选中任何文本时，统计整个文件

## [1.0.4] - 2022-06-11

- 设置面板中的路径统一将默认值设置为空字符串，避免不存在的路径对用户造成干扰
- 修复读取剧本配置时关掉消息框而非点击“打开输出面板”也会打开输出面板的bug
- 现在可以在剧本配置中用“#tl”或者“timeline”（不区分大小写）来配置导出xml时的timeline文件的路径了
- 昨天合成语音时发现生成的是rgl文件而非txt文件，修复了一下，现在大概可以打开处理后的文件了
- 将文档里的介绍视频的链接改为了[【回声工坊】插件：跑团replay视频制作程序的vscode辅助扩展，让效率再上一层楼！](https://www.bilibili.com/video/BV1Xv4y1u7RC/)

## [1.0.3] - 2022-06-10

- 添加了两个代码片段 `fold mark`和 `current directory`

## [1.0.2] - 2022-06-10

- 给几个用到终端的命令的消息提示加了个跳转到输出面板的按钮

## [1.0.1] - 2022-06-10

- 修复 `TRGL: Play Video`以及 `TRGL: Export Video`命令的bug（这个bug很怪，目前还没想出来是怎么回事，改了之后怎么就可以运行了，It just work！）
- 修复了会出现多个输出框的bug
- 修复了会出现多个终端的bug
- 在 `TRGL: Synthesized Speech`命令中添加了一个按钮消息弹框，语音合成完毕后可以手动打开合成好的 `AsteriskMarkedLogFile.txt`（找不到监听终端运行结束指令的替代方案）

## [1.0.0] - 2022-06-09

- 新增命令 `TRGL: Define Character`，可以根据已有的log文件自动生成角色配置表
- 至此，本插件已经基本完善，实现了一开始想要完成的所有功能，正式改版本号为 `1.0.0`

## [0.9.0] - 2022-06-09

- 新增命令：`TRGL: Export Video`,`TRGL: Synthesized Speech`,`TRGL: Export XML`
- 新增配置项：“先执行语音合成”、“导出XML”、“timeline文件路径”

## [0.8.1] - 2022-06-09

- `TRGL: Play Video`命令现在可以从当前文件中读取配置了，若找不到对应的配置项，则使用全局配置。
- 优化配置项的文本描述以及分类

## [0.8.0] - 2022-06-08

- 新增命令 `TRGL: Check Dialog Line Length`：找出超出指定字数的对话行

## [0.7.0] - 2022-06-08

- 现在可以在vscode里面用“TRGL: Play Video”命令播放当前rgl文件了，只要你在设置内（ctrl+逗号，调出设置面板，找到“回声工坊插件设置”）配置好媒体定义文件路径、角色表文件路径，其他的可以用默认值。

## [0.6.0] - 2022-06-08

- 新增了三个正则表达式替换的命令。“TRGL: Replace Angle Brackets”、“TRGL: Add Asterisk Marks”、“TRGL: Add Sound Effects In Batches”
- 规范了命令的格式，统一加上了前缀“TRGL:”
- 添加“TRGL: Count”命令的详细输出内容

## [0.5.1] - 2022-06-08

- 添加“Define Media”命令的输出内容，会将因为媒体名称不合法而跳过的文件列出来。
- 删除了“Hello World”命令

## [0.5.0] - 2022-06-08

- 新增“Define Media”命令，根据指定路径内的媒体素材生成媒体定义文件

## [0.4.1] - 2022-06-06

- 修复了hitpoint动画预估时长不正确的问题

## [0.4.0] - 2022-06-06

- 命令“RGL Count”新增估算视频长度的功能

## [0.3.2] - 2022-06-05

- 新增三个常用正则表达式片段，便于复制，触发词前缀是regex。分别是“将跑团记录着色器得到的尖括号替换为方括号与冒号”，“批量给对话行末尾添加待处理星标“{*}”。”，“给某个特定角色对话行末尾加特定音效。”

## [0.3.1] - 2022-06-05

- 修复“RGL Count”命令在无背景行时报错的问题

## [0.3.0] - 2022-06-03

- 新增“RGL Count”命令，可以统计对话行和骰子行的行数，并将rgl文件中提到的所有角色和背景不重复地列出，方便填写角色配置表和定义背景媒体

## [0.2.2] - 2022-06-03

- 对话行语法的检测更加严格，超过三个PC名或者将透明度括号写在差分后面的情况现在会标红

## [0.2.1] - 2022-06-01

- 修复rgl主题的白色过于晃眼的bug，改为了灰色

## [0.2.0] - 2022-06-01

- 新增代码折叠功能，在想要折叠的起始行和末尾行分别加上 `#s`和 `#e`的注释，即可对中间的内容进行折叠，可以嵌套，而且这两个边界标记后面可以加注释，例如 `#s 这是折叠的起始行，意思是start`，`#e 这是折叠的末尾行，意思是end`。

## [0.1.3] - 2022-06-01

- 添加了代码片段 `one dice`的触发词：`dice1`
- 添加了代码片段 `audio`的触发词：`aa`，方便快速输入音效
- 修复了代码片段 `background cross`的触发词为 `background black`的bug
- 为背景行的代码片段的切换方式的时间参数处设定了占位符。例如 `<background><replace=【这个地方新增了占位符】>:背景媒体`
- 优化README.md的表述，添加介绍视频的链接
- 优化更新日志文档（即本文档）

## [0.1.2] - 2022-05-31

- 添加了插件的图标

## [0.1.1] - 2022-05-31

- 修复代码片段“audio”占位符的错误

## [0.1.0] - 2022-05-31

- 完成常用代码片段的集成

## [0.0.1] - 2022-05-31

- 完成rgl代码高亮
